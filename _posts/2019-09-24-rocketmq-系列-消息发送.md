---
layout: post
title: "RocketMQ 系列 生产者"
subtitle: '刨析rocketMQ的底层实现'
author: "lichao"
header-img: "img/post-bg-rwd.jpg"
catalog: true
tags:
  - rocketMQ
---

RocketMQ 发送普通消息有三种实现方式：
* 可靠同步发送
* 可靠异步发送
* 单向(Oneway）发送。

## 概念
#### 故障延迟机制
消息发送端采用重试机制，选择消息队列有两种方式。
**获取机制**
直接用sendWhichQueue 自增再获取值， 与当前路由表中消息队列个数取模， 返回该位置的MessageQueue。
如果消息发送再失败的话，下次进行消息队列选择时规避上次MesageQueue 所在的Broker， 否则还是很有可能再次失败。

## 问题
#### 消息队列如何进行负载？
根据*路由信息*选择消息队列，返回的消息队列按照broker 、序号排序。

消息发送端采用重试机制.
#### 消息发送如何实现高可用？
#### 批量消息发送如何实现一致性？
