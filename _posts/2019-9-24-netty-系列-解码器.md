---
layout: post
title: "Netty 系列 粘包.拆包"
author: "lichao"
header-img: "img/netty/host.png"
catalog: true
tags:
  - netty
---

> 将字节流转换成消息的解码器

Netty 的解码器有很多种，比如基于长度的，基于分割符的，私有协议的。但是总体的思路都是一致的。
## 概念
拆包思路：当数据满足了 解码条件时，将其拆开。放到数组。然后发送到业务 handler 处理。

半包思路： 当读取的数据不够时，先存起来，直到满足解码条件后，放进数组。送到业务 handler 处理。

## 概念
#### frame 帧

## 解析器
一般情况下，通过添加***FrameDecoder帧解码器，在管道pipeline中尽早地处理数据。
* DelimiterBasedFrameDecoder:以某个分割符为一帧 
* FixedLengthFrameDecoder：以固定长度字节为一帧 
* LineBasedFrameDecoder：以换行符为一帧 
* LengthFieldBasedFrameDecoder：这种针对，协议有不同的部分组成，如头部，数据部分，头部中包含数据长度信息的情况。

#### ByteToMessageDecoder

* **所有ByteToMessageDecoder解码器的子类不能被Sharable注解**
* 如果ByteBuf.readBytes(int)方法的返回buffer没有被释放，可能造成内存泄漏
