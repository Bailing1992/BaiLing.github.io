---
layout: post
title: "Mysql 系列 磁盘阵列"
subtitle: '《Mysql 技术内幕：InnoDB存储引擎》'
author: "lichao"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
  - mysql
---
 > RAID 基本思想就是把多个相对便宜的硬盘组合起来，使其组合成一个容量更大、更安全的硬盘组.目前已有的RAID硬盘组方案至少有几十种，其最常用的要数RAID5与RAID10硬盘组方案。

* 软RAID(software-based RAID)是基于软件的RAID。它可能是最普遍的被使用的RAID阵列，这是由于现在的很多服务器操作系统都集成了RAID功能。

* 硬RAID（这里只讨论基于总线的RAID）是由内建RAID功能的主机总线适配器（Host bus adapter）控制，直接连接到服务器的系统总线上的。

 ### RAID 0
即Data Stripping数据分条技术。RAID 0可以把多块硬盘连成一个容量更大的硬盘群，可以提高磁盘的性能和吞吐量。RAID 0没有冗余或错误修复能力，成本低，要求至少两个磁盘，一般只是在那些对数据安全性要求不高的情况下才被使用。

#### 简单RAID 0
就是把x块同样的硬盘 **用硬件的形式** 通过智能磁盘控制器或用操作系统中的磁盘驱动程序**以软件的方式**串联在一起，形成一个独立的逻辑驱动器，容量是单独硬盘的x倍,在电脑数据写时被依次写入到各磁盘中，当一块磁盘的空间用尽时，数据就会被自动写入到下一块磁盘中，它的好处是可以增加磁盘的容量。速度与其中任何一块磁盘的速度相同，如果其中的任何一块磁盘出现故障，整个系统将会受到破坏，可靠性是单独使用一块硬盘的1/n。
#### 另一种RAID 0
是用n块硬盘选择合理的带区大小创建带区集，最好是为每一块硬盘都配备一个专门的磁盘控制器,在电脑数据读写时同时向n块磁盘读写数据,速度提升n倍。提高系统的性能。
### RAID 1
RAID 1称为磁盘镜像：把一个磁盘的数据镜像到另一个磁盘上，在不影响性能情况下最大限度的保证系统的可靠性和可修复性上，具有很高的数据冗余能力，但磁盘利用率为50%，故成本最高，多用在保存关键性的重要数据的场合。RAID 1有以下特点：  
1. RAID 1的每一个磁盘都具有一个对应的镜像盘，任何时候数据都同步镜像，系统可以从一组镜像盘中的任何一个磁盘读取数据。
2. 磁盘所能使用的空间只有磁盘容量总和的一半，系统成本高
3. 只要系统中任何一对镜像盘中至少有一块磁盘可以使用，甚至可以在一半数量的硬盘出现问题时系统都可以正常运行。
4. 出现硬盘故障的RAID系统不再可靠，应当及时的更换损坏的硬盘，否则剩余的镜像盘也出现问题，那么整个系统就会崩溃。
5. 更换新盘后原有数据会需要很长时间同步镜像，外界对数据的访问不会受到影响，只是这时整个系统的性能有所下降。
6. RAID 1磁盘控制器的负载相当大，用多个磁盘控制器可以提高数据的安全性和可用性。
### RAID 0+1
把RAID0和RAID1技术结合起来，数据除分布在多个盘上外，每个盘都有其物理镜像盘，提供全冗余能力，允许一个以下磁盘故障，而不影响数据可用性，并具有快速读/写能力。RAID0+1要在磁盘镜像中建立带区集至少4个硬盘。 
### RAID2
在写入数据时在一个磁盘上保存数据的各个位，同时把一个数据不同的位运算得到的海明校验码保存另一组磁盘上，由于海明码可以在数据发生错误的情况下将错误校正，以保证输出的正确。但海明码使用数据冗余技术，使得输出数据的速率取决于驱动器组中速度最慢的磁盘。RAID2控制器的设计简单。
### RAID3：带奇偶校验码的并行传送 
RAID 3使用一个专门的磁盘存放所有的校验数据，而在剩余的磁盘中创建带区集分散数据的读写操作。当一个完好的RAID 3系统中读取数据，只需要在数据存储盘中找到相应的数据块进行读取操作即可。但当向RAID 3写入数据时，必须计算与该数据块同处一个带区的所有数据块的校验值，并将新值重新写入到校验块中，这样无形虽增加系统开销。当一块磁盘失效时，该磁盘上的所有数据块必须使用校验信息重新建立，如果所要读取的数据块正好位于已经损坏的磁盘，则必须同时读取同一带区中的所有其它数据块，并根据校验值重建丢失的数据，这使系统减慢。当更换了损坏的磁盘后，系统必须一个数据块一个数据块的重建坏盘中的数据，整个系统的性能会受到严重的影响。RAID 3最大不足是校验盘很容易成为整个系统的瓶颈，对于经常大量写入操作的应用会导致整个RAID系统性能的下降。RAID 3适合用于数据库和WEB服务器等。
### RAID4
RAID4即带奇偶校验码的独立磁盘结构，RAID4和RAID3很象，它对数据的访问是按数据块进行的，也就是按磁盘进行的，每次是一个盘，RAID4的特点和RAID3也挺象，不过在失败恢复时，它的难度可要比RAID3大得多了，控制器的设计难度也要大许多，而且访问数据的效率不怎么好。 
### RAID 5
RAID 5把校验块分散到所有的数据盘中。RAID 5使用了一种特殊的算法，可以计算出任何一个带区校验块的存放位置。这样就可以确保任何对校验块进行的读写操作都会在所有的RAID磁盘中进行均衡，从而消除了产生瓶颈的可能。RAID5的读出效率很高，写入效率一般，块式的集体访问效率不错。RAID 5提高了系统可靠性，但对数据传输的并行性解决不好，而且控制器的设计也相当困难。