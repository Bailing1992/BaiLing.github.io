---
layout: post
title: "redis 系列 综述"
subtitle: '开启 redis 探索新篇章'
author: "lichao"
header-img: "img/post-bg-rwd.jpg"
catalog: true
tags:
  - redis 
---

> Redis(Remote Dictionary Service) 远程字典服务


## 常见使用场景
* 缓存
* 存储（业务对丢失少量数据不敏感）
    * 线上存储型的 Redis 开启 aof 落盘
    * 异步落盘
## Redis Cluster 架构痛点
* Redis Cluster 集群规模限制（300个实例 150分片）
    * 大概集群内超过 300 个实例的时候，gossip 风暴问题严重
* 同城多机房之间同步
    *  在 Redis cluster 架构下，同地域内的多个机房的 Redis 集群是相互独立的，机房之间的同步是由另一个单独的组件来做的，这样的一致性和主从切换之后的增量复制都支持的不太好
    *  对于一些灾难场景，比如两个机房之间网络断掉，或者是全量把 Master 切机房等场景，这样的切换在 Redis Cluster 模式下会需要做全量同步，这时候很容易把带宽给打的很满，影响线上服务

## 中心化和去中心化
#### 去中心化架构
在 Redis Cluster 中，拓扑信息是保存在每个 Redis 实例中的，有拓扑变更时，会通过 gossip 协议扩散到其他所有 Redis 实例里。在实践中我们发现，去中心化的架构在实例数很多的情况下，会产生 gossip 风暴的问题，即用于同步 topom 数据会占用了很大一部分带宽，同时，在线上有非常多的 Redis 集群，对于整体的管理和调度，也很不方便。
#### 中心化架构
中心化管理的方式需要有一个组件，用来统一管理所有 Redis 集群的拓扑信息。并且暴露出一些方便的运维接口，响应平台的创建/扩容/线下请求，并将 Redis 的元信息持久化，对 Redis进行探活，主从切换。



## 问题
#### Redis 是如何进行主从同步

#### Redis 集群如何扩容和缩容

#### Redis 存在的问题
* Redis 是基于内存的，内存是很昂贵的
* 不能保证数据持久化，虽然redis有存储方案，但是 aof 持久化也有很多问题。
* Redis Cluster 的分布式方案，是基于 gossip 协议的，当数据量太大的时候，会有 gossip 风暴的问题。