---
layout: post
title: "NoSQL 概述"
subtitle: '分析 高可用的分布式 KV 存储'
author: "lichao"
header-img: "img/post/bg/post-bg-rwd.jpg"
catalog: true
tags:
  - nosql 
---

分布式数据库NoSQL是一种非关系型数据库，采用了键值对、文档、列族、图等数据模型，具有高度的可伸缩性和灵活性，用于大规模存储和处理分布式数据。

NoSQL 大致可以分为以下几类：

* KV 类：以 Redis 为代表；
* 文档存储：以 MongoDB 为代表，文档存储一般用类似json的格式存储，存储的内容是文档型的。这样也就有机会对某些字段建立索引，实现关系数据库的某些功能。
* 列存储：以 HBase 为代表，顾名思义，是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的IO优势。
* 图、时序等新兴的数据库也都属于 NoSQL 范畴。

## 优势与特性

NoSQL数据库适用于互联网应用、物联网、日志存储等应用场景，特别是需要处理大规模数据和高并发访问的场景。

### 易扩展

NoSQL数据库种类繁多，但是一个共同的特点都是去掉关系数据库的关系型特性。数据之间无关系，这样就非常容易扩展。也无形之间，在架构的层面上带来了可扩展的能力。

NoSQL数据库可以轻松地进行横向扩展，通过添加更多的节点来增加存储容量和处理能力。这种可伸缩性使得NoSQL数据库可以处理大规模数据和高并发访问的需求。

### 大数据量，高性能

NoSQL数据库都具有非常高的读写性能，尤其在大数据量下，同样表现优秀。这得益于它的无关系性，数据库的结构简单。一般MySQL使用Query Cache，每次表的更新Cache就失效，是一种大粒度的Cache，在针对web2.0的交互频繁的应用，Cache性能不高。而NoSQL的Cache是记录级的，是一种细粒度的Cache，所以NoSQL在这个层面上来说就要性能高很多了。

### 一致性

NoSQL数据库的一致性模型分为强一致性、弱一致性和最终一致性。强一致性要求数据的更新在所有副本中立即可见，弱一致性允许数据的更新在一定时间内不可见，最终一致性则保证最终所有副本达到一致状态。

* 强一致性：采用 Paxos 或者 Raft 协议来保证数据的强一致。
* 最终一致性：一般是通过数据复制实现最终一致性，数据的复制支持同步复制、异步复制和半同步复制。业务可以根据自己的业务特点选择合适的复制方式。其中半同步复制时，会保证备机写入成功才会返回客户端成功，这样保证不会有数据丢失。

### 灵活的数据模型

NoSQL数据库可以根据需求选择不同的数据模型，如键值对、文档、列族、图等，以适应不同的应用场景。这种灵活性使得NoSQL数据库适用于各种不同类型的数据存储需求。

NoSQL无需事先为要存储的数据建立字段，随时可以存储自定义的数据格式。而在关系数据库里，增删字段是一件非常麻烦的事情。如果是非常大数据量的表，增加字段简直就是一个噩梦。这点在大数据量的web2.0时代尤其明显。

### 可用性与一致性

由 CAP 原理可知，任何分布式系统都需要在一致性和可用性之间取舍，这就出现了两类存储系统：

1. 高可用，最终一致的存储系统
   * Redis
2. 强一致的系统
   * 提供数据强一致性能够大大减小业务的负担

### 高可用

NoSQL在不太影响性能的情况，就可以方便的实现高可用的架构。比如Cassandra，HBase模型，通过复制模型也能实现高可用。
